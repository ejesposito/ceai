pkg load statisticsrandn("seed", 1234)% numero de simulacionesn = 2000;% numero de muestrasN = 10;% media muestral% la usamos como media de distribucion en el ejerciciomu_muestral = 48;% dispersionsigma = 4;% el intervalo de confianza de 95% teorico es:mu_min_teorico = mu_muestral - 1.96*sigma/sqrt(N)mu_max_teorico = mu_muestral + 1.96*sigma/sqrt(N)% nivel de confianza del intervalo, deberia ser igual a 0.95 al final de la simulacionconfianza = 0;for i=1:n    % generar  una muestra de la distribucion de medias muestrales    X = sigma/sqrt(N)*randn+ mu_muestral;    %  chequeo cuantos valores estan en el intervalo de confianza    confianza = confianza + (1/n) *(X>=mu_min_teorico & X<=mu_max_teorico);end% estimacion del intervalo de confianzaconfianza_simulado = confianza confianza_teorico = 0.95% *************************% verificar el test de hipotesis% mu de H0mu0 = 45;% calculo el fractil z que resultante del testz0 =  (mu_muestral - mu0)/(sigma/sqrt(N));% como mu0 < mu_muestral, voy a buscar cuantas muestras son menores o iguales que mu0% significancia del testalpha = 0.05;% proporcion de valores de la v.a. menores que mu0% primero centramos una normal en mu_muestral con dispersion sigma/sqrt(N)% si la proporcion de muestras menores que la mu0 es menor que alpha/2, quiere decir que la hipotesis nula tiene muy poca probabilidad de ser valida, basado en el mu_muestra observado y la dispersion y N, entonces rechazamos la hipotesis nula% esto es lo mismo que comparar z0 > 1.96, dado que z0 es positivaproporcionMenorQueMu = 0;% simulo una normal centrada en mu_muestralfor i=1:n    % generar distribucion    % esta surge de la estimacion de media muestral    % centramos una distribucion en la mu_muestral    X = sigma/sqrt(N)*randn + mu_muestral;    %  chequeo cuantos valores estan fuera de alpha/2 del area de error    proporcionMenorQueMu = proporcionMenorQueMu + 1/n*(X < mu0);end% dado z0, cual es el area esperable por encima (o por debajo) de z0% si este area es mayor (o menor) que alpha/2, rechazamos la hipotesis nula% ya que tiene muy baja probabilidad de ser verdadera con una significancia alphaproporcionMuestrasMenorMuTeorica = 1-normcdf(z0)proporcionMenorQueMu% comparo el valor encontrado por simulacion con alpha/2if(proporcionMenorQueMu< alpha/2)    disp('Rechazar H0')else    disp('Aceptar H0')end% *****************% otra forma de lograr lo mismo% nivel de confianza del intervaloconfianza = 0;for i=1:n    % Centro una gausiana en la hipotesis nula    X = sigma/sqrt(N)*randn + mu0;    % Verificamos cuantos valores de esa gaussiana exceden la media muestra (porque mu>mu0, si no deberiamos preguntar por menor, mu<mu0)    confianza = confianza + (1/n) * (X>=mu_muestral);end% para aceptar H0, como minimo deben haber alpha/2 muestrasmuestras_minimas_requeridas = alpha/2muestras_en_el_intervalo = confianzaif(confianza<muestras_minimas_requeridas)    disp('Rechazar H0') else    disp('Aceptar H0')end