pkg load statisticsclose allrand("seed",1234);betarnd("seed",1234);binornd("seed",1234);% numero de simulacionesn = 500;% parametros de la distribucion a priori de theta (creencia de theta)% si la creencia es incorrecta, es probable que no encuentre un valor correcto de MAP% esto es porque con creencia incorrecta, el theta a priori no me va a generar datos correctos de la verosimilitud% media de theta a prioritheta0 = 1;% varianza de theta a priorisigma0_2 = 1;% varianza de la muestra xsigma_x_2 = 0.1;   %  genero la distribucion a priori de theta, n experimentostheta_a_priori_vect = sqrt(sigma0_2)*randn(n,1) + theta0;% x_dado_theta_vectorx_dado_theta_vector= zeros(n,n);% arg max theta, all NaNtheta_arg_max = NaN*ones(n,1);% promedio muestral por dato (medicion)x_promedio_muestral_dato = 1.5;% tolerancia en la condicion de dato muestraltol = 0.05*x_promedio_muestral_dato;for i=1:n            % theta a priori      theta_a_priori = theta_a_priori_vect(i);      % genero la verosimilitud      x_dado_theta_vector(i,:)  = sqrt(sigma_x_2) * randn(n,1) + theta_a_priori;            % calculo el promedio muestral de la versomilitud      x_promedio_muestral = mean(x_dado_theta_vector(i,:));      % chequeo si el promedio muestral calculado contiene al dato x_promedio_muestral_dato      % incluyo una tolerancia      if((x_promedio_muestral > x_promedio_muestral_dato - tol) &&  ...             (x_promedio_muestral < x_promedio_muestral_dato + tol))          % guardo el valor de theta que hizo coincidir el dato con el calculo          theta_arg_max(i) = theta_a_priori;        end     endfor% promedio los theta_arg_max que cumplen con la muestra (media a posteriori)  % ignoro los NaN en el promedio usando nanmean() theta_map_practico = nanmean(theta_arg_max)  % valor de theta map teorico theta_map_teorico = (sigma_x_2 / (sigma0_2 + sigma_x_2)) * theta0 +...                                                                  (sigma0_2 / (sigma0_2 + sigma_x_2)) * x_promedio_muestral_dato